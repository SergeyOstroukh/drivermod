# Как выполнить миграцию в Supabase

## Пошаговая инструкция

### Шаг 1: Откройте Supabase Dashboard

1. Перейдите на https://supabase.com/dashboard
2. Войдите в свой аккаунт
3. Выберите ваш проект **mrdicoctfaxdrmoluqpi**

### Шаг 2: Откройте SQL Editor

1. В левом боковом меню найдите и нажмите **SQL Editor**
   - Иконка выглядит как символы `</>` или "SQL"
   - Обычно находится в разделе "Development"

2. Нажмите кнопку **New query** (Новый запрос)
   - Или используйте горячую клавишу `Ctrl+N` (Windows) / `Cmd+N` (Mac)

### Шаг 3: Выберите нужную миграцию

**Если таблицы водителей и автомобилей еще НЕ созданы:**
- Откройте файл `supabase/migrations/COMPLETE_VEHICLES_SETUP.sql`
- Скопируйте **ВЕСЬ** код из файла (Ctrl+A, Ctrl+C)

**Если таблицы УЖЕ созданы, но нужно добавить новые поля:**
- Откройте файл `supabase/migrations/005_add_vehicle_dates.sql`
- Скопируйте **ВЕСЬ** код из файла

### Шаг 4: Вставьте и выполните SQL

1. В SQL Editor в Supabase вставьте скопированный код (Ctrl+V)

2. Нажмите кнопку **Run** (Запустить)
   - Или используйте горячую клавишу `Ctrl+Enter` (Windows) / `Cmd+Enter` (Mac)

3. Дождитесь выполнения (обычно несколько секунд)

4. Внизу должно появиться сообщение об успешном выполнении:
   - ✅ "Success. No rows returned" или
   - ✅ "Success" с количеством выполненных команд

### Шаг 5: Проверьте результат

1. В левом меню нажмите **Table Editor**

2. Проверьте наличие таблиц:
   - `drivers` (водители)
   - `vehicles` (автомобили)

3. Откройте таблицу `vehicles` и проверьте наличие новых полей:
   - `inspection_start`
   - `insurance_start`
   - `oil_change_mileage`

## Визуальная инструкция

```
┌─────────────────────────────────────────┐
│  Supabase Dashboard                     │
│                                         │
│  [Project: mrdicoctfaxdrmoluqpi]       │
│  ├── Table Editor                       │
│  ├── SQL Editor ← НАЖМИТЕ СЮДА         │
│  ├── Database                           │
│  └── Settings                           │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│  SQL Editor                             │
│  [New query] [Save] [Run] ← НАЖМИТЕ    │
├─────────────────────────────────────────┤
│                                         │
│  -- Вставьте SQL код сюда               │
│                                         │
└─────────────────────────────────────────┘
```

## Быстрая проверка

После выполнения миграции выполните этот запрос в SQL Editor:

```sql
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'vehicles' 
ORDER BY ordinal_position;
```

Должны увидеть все поля, включая новые:
- `inspection_start`
- `insurance_start`
- `oil_change_mileage`

## Решение проблем

### Ошибка: "relation already exists"
- Таблица уже существует
- Используйте миграцию `005_add_vehicle_dates.sql` для добавления полей

### Ошибка: "column already exists"
- Поля уже добавлены
- Всё в порядке, можно продолжать работу

### Ошибка: "permission denied"
- Убедитесь, что вы вошли в правильный проект
- Проверьте, что вы владелец проекта

### Не вижу таблицу в Table Editor
- Обновите страницу (F5)
- Проверьте, что выполнили SQL без ошибок
- Посмотрите в консоль браузера (F12)

## Готово!

После выполнения миграции:
1. ✅ Таблицы созданы/обновлены
2. ✅ Политики безопасности настроены
3. ✅ Можно открывать `index.html` и работать с приложением

