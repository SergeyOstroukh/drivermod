<!doctype html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>Маршруты к поставщикам</title>
	<link rel="stylesheet" href="styles.css">
	<link rel="preconnect" href="https://yastatic.net">
	<meta name="theme-color" content="#111827">
</head>
<body>
	<header class="header">
		<h1>Поставщики</h1>
		<label class="search">
			<input id="searchInput" class="search-input" type="search" placeholder="Поиск по названию" autocomplete="off" />
		</label>
		<div class="header-actions">
			<button id="addSupplierBtn" class="btn btn-primary" type="button">
				<svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<line x1="12" y1="5" x2="12" y2="19"></line>
					<line x1="5" y1="12" x2="19" y2="12"></line>
				</svg>
				Добавить
			</button>
			<button id="officeBtn" class="btn btn-secondary" type="button">
				<svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
					<circle cx="12" cy="10" r="3"></circle>
				</svg>
				Офис
			</button>
			<button id="warehouseBtn" class="btn btn-secondary" type="button">
				<svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
					<circle cx="12" cy="10" r="3"></circle>
				</svg>
				Склад
			</button>
			<button id="detectLocationBtn" class="btn btn-secondary" type="button">Обновить геопозицию</button>
		</div>
	</header>

	<main id="app" class="container">
		<section id="status" class="status">
			<span id="geoStatus">Ожидание геопозиции…</span>
		</section>

		<section class="route-section">
			<button id="buildRouteBtn" class="btn btn-primary route-btn" type="button" disabled>
				Поехать по маршруту
			</button>
			<button id="clearSelectionBtn" class="btn btn-outline route-btn" type="button">
				Сбросить выбранное
			</button>
		</section>

		<section>
			<ul id="suppliersList" class="cards"></ul>
		</section>
	</main>

	<footer class="footer">
		<div>© <span id="year"></span> Маршруты к поставщикам</div>
	</footer>

	<div id="routeModal" class="modal">
		<div class="modal-content">
			<h3 class="modal-title">Выберите способ открытия маршрута</h3>
			<div id="navigatorWarning" class="modal-warning" style="display: none;">
				<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<path d="M12 9v4m0 4h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0z"></path>
				</svg>
				<span>Лимит: 5 вызовов в сутки без ключа API</span>
			</div>
			<div id="multiRouteWarning" class="modal-warning modal-info" style="display: none;">
				<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0z"></path>
				</svg>
				<span>Для множественных точек откроется Яндекс.Карты, оттуда можно открыть в навигаторе</span>
			</div>
			<div class="modal-actions">
				<button id="openNaviBtn" class="btn btn-primary modal-btn">
					<svg class="btn-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
						<circle cx="12" cy="10" r="3"></circle>
					</svg>
					Яндекс.Навигатор
				</button>
				<button id="openMapsBtn" class="btn btn-outline modal-btn">
					<svg class="btn-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
						<circle cx="12" cy="10" r="3"></circle>
					</svg>
					Яндекс.Карты
				</button>
				<button id="cancelRouteBtn" class="btn btn-outline modal-btn">
					Отмена
				</button>
			</div>
		</div>
	</div>

	<div id="supplierModal" class="modal">
		<div class="modal-content modal-content-large">
			<h3 class="modal-title" id="supplierModalTitle">Добавить поставщика</h3>
			<form id="supplierForm" class="supplier-form">
				<div class="form-group">
					<label for="supplierName" class="form-label">Название *</label>
					<input type="text" id="supplierName" name="name" class="form-input" required placeholder="Например: Агропарк-М" />
				</div>
				<div class="form-group">
					<label for="supplierAddress" class="form-label">Адрес</label>
					<input type="text" id="supplierAddress" name="address" class="form-input" placeholder="Например: 4 пер. монтажников 5" />
				</div>
				<div class="form-group">
					<label for="supplierLat" class="form-label">Широта (lat) *</label>
					<input type="number" id="supplierLat" name="lat" class="form-input" step="any" required placeholder="53.874443" />
				</div>
				<div class="form-group">
					<label for="supplierLon" class="form-label">Долгота (lon) *</label>
					<input type="number" id="supplierLon" name="lon" class="form-input" step="any" required placeholder="27.413769" />
				</div>
				<div class="form-group">
					<label for="supplierInfo" class="form-label">Дополнительная информация (JSON)</label>
					<textarea id="supplierInfo" name="info" class="form-textarea" rows="4" placeholder='{"Склад": "53.874443, 27.413769", "Офис": "53.883330, 27.455246"}'></textarea>
					<small class="form-hint">Необязательное поле. JSON объект с дополнительными точками</small>
				</div>
				<div class="form-actions">
					<button type="submit" class="btn btn-primary modal-btn">Сохранить</button>
					<button type="button" id="cancelSupplierBtn" class="btn btn-outline modal-btn">Отмена</button>
					<button type="button" id="deleteSupplierBtn" class="btn btn-danger modal-btn" style="display: none;">Удалить</button>
				</div>
			</form>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.0/dist/umd/supabase.min.js"></script>
	<script src="js/config.js"></script>
	<script src="js/db.js"></script>
	<script src="js/app.js"></script>
</body>
</html>


